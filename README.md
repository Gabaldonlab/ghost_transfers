# Simulating transfers from ghost lineages

This repository contains a set of scripts that performs the simulations of ghost transfers using a backbone tree of life. The scripts can be run sequentially by executing `sbatch launch_ghosts.sh`, which will launch the job to the slurm queueing system. Loaded modules (R and python) differ between supercomputers, thus, for reproducibility one should change them to the ones installed in its server preserving the versions.

The scripts contains:
1. `01_get_branch_space.py`: this script retrieves the birth and dead ages of all the branches of the tree (the branch space).
2. `02_simulate_transfers.R`: using the branch space, the script simulates 10,000 rounds of 1,000 pairs of transfers.
3. `03_plotting_shifts.R`: this reads the output generated by the simulation and plots the proportion of shifts.
4. `04_groups_data.R`: it calculates the proportion of shifts between donors of two different groups and plots this information in a heatmap.
5. `launch_ghosts.sh`: the job script that executes all the sequence.

## Dependencies
* ete3 (v3.1.3)
* doParallel (v1.0.17)
* foreach (v1.5.2)
* ggplot2 (v3.5.1)
* ggpubr (v0.6.0.999)
* patchwork (v1.2.0)
* pheatmap (v1.0.12)
* see (v0.8.4)
* stringr (v1.5.1)
* tidyr (v1.3.1)
* tidyverse (v2.0.0)